<?require_once($_SERVER["DOCUMENT_ROOT"]."/../Common/database/db_funcs.php");require_once($_SERVER["DOCUMENT_ROOT"]."/../Common/miscellaneous/encryptation.php");require_once($_SERVER["DOCUMENT_ROOT"]."/../Common/miscellaneous/general.php");function buscarDentroFueraEdificio($legajo) {	global $conn;	$tmpConn = $conn;	$conn = oci_connect(DB_USER_RHPRO, decrypt(DB_PASS_RHPRO, "PROVART"), DB_SERV_RHPRO, "WE8ISO8859P1");	$params = array(":legajo" => $legajo);	$sql =		"SELECT DECODE(regentsal, 'E', 'in', DECODE(regentsal, 'S', 'out', NULL))			 FROM rhpror3.gti_registracion			WHERE ternro = :legajo	 ORDER BY regnro DESC";	$resultado = ValorSql($sql, "", $params);	$conn = $tmpConn;	return $resultado;}// ******* INICIO actualización dentro-fuera edificio..$params = array(":id" => $_REQUEST["id"]);$sql =	"SELECT se_legajo		 FROM use_usuarios		WHERE se_id = :id";$dentroFuera = buscarDentroFueraEdificio(ValorSql($sql, -1, $params));$params = array(":dentrofueraedificio" => $dentroFuera, ":id" => $_REQUEST["id"]);$sql =	"UPDATE use_usuarios			SET se_dentrofueraedificio = :dentrofueraedificio		WHERE se_id = :id";DBExecSql($conn, $sql, $params);// ******* FIN actualización dentro-fuera edificio..$iconTitila = "/modules/buscar_usuarios/images/dentro_del_edificio.gif";$iconRef = "/modules/buscar_usuarios/images/referencia_azul.gif";$strInOut = "Dentro del Edificio";if (($_REQUEST["c"] == 1) and ($_REQUEST["e"] != "cem.gif")) {	if ($dentroFuera != "in") {		$iconTitila = "/modules/buscar_usuarios/images/fuera_del_edificio.gif";		$iconRef = "/modules/buscar_usuarios/images/referencia_rojo.gif";		$strInOut = "Fuera del Edificio";	}}else	$strInOut = "(No Registra Datos)";?><script>	function cargarInfo() {		with (parent.document) {<?if ($_REQUEST["e"] == "cem.gif") {?>	getElementById('imgCoordenada').style.display = 'none';<?}?>			getElementById('imgCoordenada').src = '<?= $iconTitila?>';			getElementById('imgReferencia').src ='<?= $iconRef?>';			getElementById('spanLeyenda').innerText = '<?= $strInOut?>';		}	}	setTimeout("cargarInfo()", 1000);</script>